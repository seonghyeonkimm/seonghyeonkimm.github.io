<!DOCTYPE html><html lang="ko" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>React SSR하는 세 가지 방법 (2)</title><meta name="robots" content="follow, index"/><meta name="description" content="React SSR하는 두 번째 방법으로 next.js, serverless-next.js를 활용해서 구현을 해보았다."/><meta property="og:url" content="https://seonghyeonkimm.github.io//blog/second-react-ssr"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Seonghyeon Kim"/><meta property="og:description" content="React SSR하는 두 번째 방법으로 next.js, serverless-next.js를 활용해서 구현을 해보았다."/><meta property="og:title" content="React SSR하는 세 가지 방법 (2)"/><meta property="og:image" content="https://seonghyeonkimm.github.io//static/images/og-card.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://x.com/seonghyeon___"/><meta name="twitter:title" content="React SSR하는 세 가지 방법 (2)"/><meta name="twitter:description" content="React SSR하는 두 번째 방법으로 next.js, serverless-next.js를 활용해서 구현을 해보았다."/><meta name="twitter:image" content="https://seonghyeonkimm.github.io//static/images/og-card.png"/><link rel="canonical" href="https://seonghyeonkimm.github.io//blog/second-react-ssr"/><meta property="article:published_time" content="2020-01-14T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://seonghyeonkimm.github.io//blog/second-react-ssr"
  },
  "headline": "React SSR하는 세 가지 방법 (2)",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://seonghyeonkimm.github.io//static/images/og-card.png"
    }
  ],
  "datePublished": "2020-01-14T00:00:00.000Z",
  "dateModified": "2020-01-14T00:00:00.000Z",
  "author": [
    {
      "@type": "Person"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Seonghyeon Kim",
    "logo": {
      "@type": "ImageObject",
      "url": "https://seonghyeonkimm.github.io//static/images/logo.png"
    }
  },
  "description": "React SSR하는 두 번째 방법으로 next.js, serverless-next.js를 활용해서 구현을 해보았다."
}</script><meta name="next-head-count" content="20"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/19c7d5d6c70b779f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/19c7d5d6c70b779f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-51f5716a975af4ab.js" defer=""></script><script src="/_next/static/chunks/main-4ef043329e44a116.js" defer=""></script><script src="/_next/static/chunks/pages/_app-5234d2fcb5d683fc.js" defer=""></script><script src="/_next/static/chunks/170-510ab59698f42a3e.js" defer=""></script><script src="/_next/static/chunks/913-1d8c22d084049560.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-0051806e725ec9a7.js" defer=""></script><script src="/_next/static/6Krvmak2ov-qcCHuSyM4j/_buildManifest.js" defer=""></script><script src="/_next/static/6Krvmak2ov-qcCHuSyM4j/_ssgManifest.js" defer=""></script><script src="/_next/static/6Krvmak2ov-qcCHuSyM4j/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><noscript><iframe title="gtm-iframe" height="0" width="0" style="display:none;visibility:hidden" src="https://www.googletagmanager.com/ns.html?id=GTM-KJNTQFR"></iframe></noscript><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Seonghyeon Kim" href="/"><div class="flex items-center justify-between"><div class="hidden h-6 text-2xl font-semibold sm:block">Seonghyeon Kim</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about/ko">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-24 right-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed h-full w-full cursor-auto focus:outline-none"></button><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about/ko">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2020-01-14T00:00:00.000Z">2020년 1월 14일 화요일</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">React SSR하는 세 가지 방법 (2)</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100"></dd><dt class="sr-only">X</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><h2 id="처음-생각했던-구현-방향"><a href="#처음-생각했던-구현-방향" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>처음 생각했던 구현 방향</h2><p>  next.js가 serverless target build 기능을 release한 지 그리 오래 되진 않았지만 꽤 시간이 흘렀다. 그때 당시에는 꼭 한번 사용해봐야지라는 생각만 했었다. 그래서 이번 글을 써야 겠다라고 마음을 먹고 머릿속으로 어떻게 구현할 수 있을까 고민하기 시작했때에는 다음과 같이 구현 해야 겠다고 생각헀다. next.js page들을 lambda 함수로 build하고 api-gateway를 활용해서 각 lambda들을 call하게 해주고, cache는 ElasticCache를 통해서 api 혹은 page를 render한 결과물을 cache하는 형태로 구성해야겠다라고 생각을 했었다. 그런데 직접 코드를 치기 시작하고 이것 저것 검색을 하다 보니 <a target="_blank" rel="noopener noreferrer" href="https://github.com/danielcondemarin/serverless-next.js/tree/master/packages/serverless-nextjs-component">serverless-next.js</a>라는 것을 알게 되었다. 또한 친절하게 소개되어 있는 <a target="_blank" rel="noopener noreferrer" href="https://serverless.com/blog/serverless-nextjs/">블로그 글</a>도 있었다. 읽어 보니 이대로 실습을 해보는 것이 더 좋겠다는 생각이 들었다.</p><h2 id="실습한-결과물-공유-및-느낀-점"><a href="#실습한-결과물-공유-및-느낀-점" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>실습한 결과물 공유 및 느낀 점</h2><blockquote><ol><li>nginx + react + express (with puppeteer) - <a target="_blank" rel="noopener noreferrer" href="https://seonghyeonkimm.github.io/first-react-ssr/">블로그 링크</a> <br/></li><li><code>next.js의 serverless</code> - <a target="_blank" rel="noopener noreferrer" href="https://github.com/seonghyeonkimm/nextjs-serverless">참고 repository</a> <br/></li><li>(coming soon) cloudFront + lambda@edge <br/></li></ol></blockquote><p>  처음 생각했던 구성대로 작업하려고 했다면 aws관련한 공부도 많이 해야 했고 꽤 많은 시간을 써야 했을 것이다. 그런데 실제로 serverless에서 소개되고 있는 블로그 글을 기반으로 하다 보니 작업이 생각보다 빨리 끝났다. 파일들을 거의 기본 next.js application과 serverless-next.js에서 필요한 config 파일 정도 뿐이다. 그래서 코드에 대한 이야기는 크게 하지 않아도 될 것 같고 serverless-next.js가 해주는 전체적인 구조와 관련된 생각 정도만 정리해 보려고 한다. 글의 초입부와 글의 마지막에 공유한 blog글에 serverless-next.js에서 구성해주는 구조를 잘 그려 두었다. 해당 이미지를 아래로 옮겨 와 보았다.</p><p><img alt="second-react-ssr-diagram" src="https://s3-us-west-2.amazonaws.com/assets.blog.serverless.com/serverless-nextjs/serverless_nextjs_lambda_edge_aws_architecture.png"/></p><p>  위의 그림을 간단히만 글로 설명한디면, user가 도메인을 입력하게 되면 cloudFront로 요청이 전달되고 build assets, user assets의 요청 같은 경우에는 바로 s3로 전달 되어 파일이 return된다. 그 이외의 정적인 <code>.html로 만들어 진 페이지, /manifest.json, /robot.txt와 같은 public assest, ssr이 필요한 page에 대한 요청, 그리고 api 요청은 lambda@edge로 전달되어 각 요청에 맞게 처리되어 return</code>된다. public asset이나 getInitialProps가 사용되지 않아서 <code>.html파일로 만들어진 파일도 lambda를 통한 다는 것이 마음에 들지 않았고 굳이 그럴 필요가 있나 생각이 들었다. 역시는 역시. 이유가 있었다.</code> cloudFront에서 cache에 대한 rule을 최대 25개까지만 만들 수 있기 때문이었다. 이 부분만 해결할 수 있는 방법이 있다면 훨씬 좋겠다라는 생각을 했다. 아쉬웠다.</p><p>  다음으로, 중요 하기도 하고 주목할 만 했던 부분이 cache와 관련된 부분이었다. <code>SSR을 하게 되면 api 요청에 대한 결과를 받고 page를 render하고 내리는 과정이 선행 되기 때문에 단순히 index.html을 받는 과정보다 오래 걸린다. 그래서 cache를 잘하는 것이 앱의 퍼포먼스에 굉장히 지대한 영향을 끼친다.</code> serverless-next.js는 크게는 두 가지 기본 cache 정책을 가지고 있다. <code>첫 번째로, build assets, user assets은 hash값과 함께 파일 이름이 생성되기 때문에 cache TTL이 max값으로 설정</code> 되어 있다. <code>두 번째로 lambda에 대한 cache 정책은 직접 변경 하지 않는 다면 기본적으로는 cache를 하지 않는다.</code></p><p>  lambda에 대한 cache 정책에 대해서는 스스로 좀 더 신경써야 할 부분이라고 생각이 든다. 기본 설정을 가지고 계속 작업 하기 보다는 <code>예를 들어서 1시간 정도는 최소한 cache하도록 설정을 변경하여 사용하는 것이 바람직하지 않을까 싶다.</code> 그리고 배포하거나 혹은 <code>cache invalidate가 필요할 때에는 cloudFront의 invalidation 기능을 사용 한다면 앱 성능면에 있어서 훨씬 도움이 될 거라는 생각이 들었다.</code> 물론 cache를 할 때에 로그인 여부, device, language등과 관련하여 <code>api data나 page가 변경될 소지가 있는 부분에 대해서는 잘 고려 하여 cache 정책을 세워야 한다.</code> 아마 다른 더 좋은 방식이 있을 수 있다. 더 좋은 cache 전략에 대해선 공부가 더 필요할 듯 하다. 물론, 실제로 서비스를 하다 보면 infra관련되어서든 application관련 되어서든 분명히 더 많은 문제들을 마주하게 되겠지만, 실습 하면서 느꼈던 점은 이 정도이다.</p><h2 id="스스로-생각해보는-장단점-및-결론"><a href="#스스로-생각해보는-장단점-및-결론" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>스스로 생각해보는 장단점 및 결론</h2><h4 id="장점"><a href="#장점" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>장점</h4><ul><li>react SSR하면 next.js이다. react에서 공식적으로 추천 하고 있다.</li><li>next.js팀이 진짜 열심히 일한다. 개선의 체감속도 진짜 빠르다.</li><li>serverless라는 점에서 infra관리에 있어서 직접 서버를 띄우는 것보다 traffic관리에 있어서 좀 덜 신경써도 된다.</li></ul><h4 id="단점"><a href="#단점" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>단점</h4><ul><li>lambda도 결국은 서버다. 많은 traffic이 몰릴 경우에 동시 처리의 수에 제한이 있다. 물론 해결할 수 있는 방법이야 있다. 그러므로 infra에 대한 관리가 여전히 필요하다.</li><li>SPA라면 굳이 server로 traffic을 전달하지 않아도 되는 <code>/*.html</code>, <code>/robots.txt</code>등의 static한 파일도 lambda를 통해야 한다.</li><li>cache가 필요하고 고려할 것들이 꽤 많다. 실제로 user와 bot이 사용하는 결과물이 일치하므로, cache할 때에 신경써야 할 것이 좀 더 많다. 예를 들면 user의 language, device, 로그인 여부들을 서버 측에서 처리 하고 캐시가 된다면 예기치 못한 에러를 만날 수 있다.</li></ul><p>  결론적으로, <code>SSR이 필요하고 cloudFront를 사용하여 서비스할 수 있는 상황이라면 사용을 고려 해보아도 좋다는 생각이 든다.</code> 직접 infra를 구현하는 것보다 훨씬 간편하다. 물론, 이미 infra관리에 익숙한 사람이라면 말이 다르겠지만. 다만 또 단점과 보완이 필요한 문제들도 있기 때문에 그런 부분에 대한 고려와 방안들을 갖추고 있다면 더할 나위 없이 좋은 선택이 될 수도 있다고 생각한다.</p><h2 id="참고한-글"><a href="#참고한-글" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>참고한 글</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="https://nextjs.org">https://nextjs.org</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://serverless.com/blog/serverless-nextjs">https://serverless.com/blog/serverless-nextjs</a></li></ul></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fseonghyeonkimm.github.io%2F%2Fblog%2Fsecond-react-ssr">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/seonghyeonkimm/seonghyeonkimm.github.io/blob/master/data/blog/second-react-ssr">View on GitHub</a></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/react">react</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/ssr">ssr</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/serverless">serverless</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/first-react-ssr">React SSR하는 세 가지 방법 (1)</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/2020-self-retrospection">2020년 반이 지나간 자리</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:impressor7@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/seonghyeonkimm"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/seonghyeon-kim-328757b7/"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://x.com/seonghyeon___"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Seonghyeon Kim</div><div> • </div><div>© 2025</div></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"React SSR하는 세 가지 방법 (2)","date":"2020-01-14T00:00:00.000Z","tags":["react","ssr","serverless"],"draft":false,"summary":"React SSR하는 두 번째 방법으로 next.js, serverless-next.js를 활용해서 구현을 해보았다.","body":{"raw":"\n## 처음 생각했던 구현 방향\n\n\u0026nbsp; next.js가 serverless target build 기능을 release한 지 그리 오래 되진 않았지만 꽤 시간이 흘렀다. 그때 당시에는 꼭 한번 사용해봐야지라는 생각만 했었다.\n그래서 이번 글을 써야 겠다라고 마음을 먹고 머릿속으로 어떻게 구현할 수 있을까 고민하기 시작했때에는 다음과 같이 구현 해야 겠다고 생각헀다. next.js page들을 lambda 함수로 build하고 api-gateway를 활용해서 각 lambda들을 call하게 해주고,\ncache는 ElasticCache를 통해서 api 혹은 page를 render한 결과물을 cache하는 형태로 구성해야겠다라고 생각을 했었다.\n그런데 직접 코드를 치기 시작하고 이것 저것 검색을 하다 보니 [serverless-next.js](https://github.com/danielcondemarin/serverless-next.js/tree/master/packages/serverless-nextjs-component)라는 것을 알게 되었다.\n또한 친절하게 소개되어 있는 [블로그 글](https://serverless.com/blog/serverless-nextjs/)도 있었다. 읽어 보니 이대로 실습을 해보는 것이 더 좋겠다는 생각이 들었다.\n\n## 실습한 결과물 공유 및 느낀 점\n\n\u003e 1. nginx + react + express (with puppeteer) - [블로그 링크](https://seonghyeonkimm.github.io/first-react-ssr/) \u003cbr /\u003e\n\u003e 2. `next.js의 serverless` - [참고 repository](https://github.com/seonghyeonkimm/nextjs-serverless) \u003cbr /\u003e\n\u003e 3. (coming soon) cloudFront + lambda@edge \u003cbr /\u003e\n\n\u0026nbsp; 처음 생각했던 구성대로 작업하려고 했다면 aws관련한 공부도 많이 해야 했고 꽤 많은 시간을 써야 했을 것이다.\n그런데 실제로 serverless에서 소개되고 있는 블로그 글을 기반으로 하다 보니 작업이 생각보다 빨리 끝났다. 파일들을 거의 기본 next.js application과 serverless-next.js에서 필요한 config 파일 정도 뿐이다.\n그래서 코드에 대한 이야기는 크게 하지 않아도 될 것 같고 serverless-next.js가 해주는 전체적인 구조와 관련된 생각 정도만 정리해 보려고 한다.\n글의 초입부와 글의 마지막에 공유한 blog글에 serverless-next.js에서 구성해주는 구조를 잘 그려 두었다. 해당 이미지를 아래로 옮겨 와 보았다.\n\n![second-react-ssr-diagram](https://s3-us-west-2.amazonaws.com/assets.blog.serverless.com/serverless-nextjs/serverless_nextjs_lambda_edge_aws_architecture.png)\n\n\u0026nbsp; 위의 그림을 간단히만 글로 설명한디면, user가 도메인을 입력하게 되면 cloudFront로 요청이 전달되고 build assets, user assets의 요청 같은 경우에는 바로 s3로 전달 되어 파일이 return된다.\n그 이외의 정적인 `.html로 만들어 진 페이지, /manifest.json, /robot.txt와 같은 public assest, ssr이 필요한 page에 대한 요청, 그리고 api 요청은 lambda@edge로 전달되어 각 요청에 맞게 처리되어 return`된다.\npublic asset이나 getInitialProps가 사용되지 않아서 `.html파일로 만들어진 파일도 lambda를 통한 다는 것이 마음에 들지 않았고 굳이 그럴 필요가 있나 생각이 들었다. 역시는 역시. 이유가 있었다.`\ncloudFront에서 cache에 대한 rule을 최대 25개까지만 만들 수 있기 때문이었다. 이 부분만 해결할 수 있는 방법이 있다면 훨씬 좋겠다라는 생각을 했다. 아쉬웠다.\n\n\u0026nbsp; 다음으로, 중요 하기도 하고 주목할 만 했던 부분이 cache와 관련된 부분이었다. `SSR을 하게 되면 api 요청에 대한 결과를 받고 page를 render하고 내리는 과정이 선행 되기 때문에 단순히 index.html을 받는 과정보다 오래 걸린다. 그래서 cache를 잘하는 것이 앱의 퍼포먼스에 굉장히 지대한 영향을 끼친다.`\nserverless-next.js는 크게는 두 가지 기본 cache 정책을 가지고 있다. `첫 번째로, build assets, user assets은 hash값과 함께 파일 이름이 생성되기 때문에 cache TTL이 max값으로 설정` 되어 있다.\n`두 번째로 lambda에 대한 cache 정책은 직접 변경 하지 않는 다면 기본적으로는 cache를 하지 않는다.`\n\n\u0026nbsp; lambda에 대한 cache 정책에 대해서는 스스로 좀 더 신경써야 할 부분이라고 생각이 든다. 기본 설정을 가지고 계속 작업 하기 보다는\n`예를 들어서 1시간 정도는 최소한 cache하도록 설정을 변경하여 사용하는 것이 바람직하지 않을까 싶다.` 그리고 배포하거나 혹은 `cache invalidate가 필요할 때에는 cloudFront의 invalidation 기능을 사용 한다면 앱 성능면에 있어서 훨씬 도움이 될 거라는 생각이 들었다.` 물론 cache를 할 때에 로그인 여부, device, language등과 관련하여 `api data나 page가 변경될 소지가 있는 부분에 대해서는 잘 고려 하여 cache 정책을 세워야 한다.`\n아마 다른 더 좋은 방식이 있을 수 있다. 더 좋은 cache 전략에 대해선 공부가 더 필요할 듯 하다. 물론, 실제로 서비스를 하다 보면 infra관련되어서든 application관련 되어서든 분명히 더 많은 문제들을 마주하게 되겠지만, 실습 하면서 느꼈던 점은 이 정도이다.\n\n## 스스로 생각해보는 장단점 및 결론\n\n#### 장점\n\n- react SSR하면 next.js이다. react에서 공식적으로 추천 하고 있다.\n- next.js팀이 진짜 열심히 일한다. 개선의 체감속도 진짜 빠르다.\n- serverless라는 점에서 infra관리에 있어서 직접 서버를 띄우는 것보다 traffic관리에 있어서 좀 덜 신경써도 된다.\n\n#### 단점\n\n- lambda도 결국은 서버다. 많은 traffic이 몰릴 경우에 동시 처리의 수에 제한이 있다. 물론 해결할 수 있는 방법이야 있다. 그러므로 infra에 대한 관리가 여전히 필요하다.\n- SPA라면 굳이 server로 traffic을 전달하지 않아도 되는 `/*.html`, `/robots.txt`등의 static한 파일도 lambda를 통해야 한다.\n- cache가 필요하고 고려할 것들이 꽤 많다. 실제로 user와 bot이 사용하는 결과물이 일치하므로, cache할 때에 신경써야 할 것이 좀 더 많다. 예를 들면 user의 language, device, 로그인 여부들을 서버 측에서 처리 하고 캐시가 된다면 예기치 못한 에러를 만날 수 있다.\n\n\u0026nbsp; 결론적으로, `SSR이 필요하고 cloudFront를 사용하여 서비스할 수 있는 상황이라면 사용을 고려 해보아도 좋다는 생각이 든다.`\n직접 infra를 구현하는 것보다 훨씬 간편하다. 물론, 이미 infra관리에 익숙한 사람이라면 말이 다르겠지만.\n다만 또 단점과 보완이 필요한 문제들도 있기 때문에 그런 부분에 대한 고려와 방안들을 갖추고 있다면 더할 나위 없이 좋은 선택이 될 수도 있다고 생각한다.\n\n## 참고한 글\n\n- https://nextjs.org\n- https://serverless.com/blog/serverless-nextjs\n","code":"var Component=(()=\u003e{var d=Object.create;var c=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=s=\u003ec(s,\"__esModule\",{value:!0});var u=(s,n)=\u003e()=\u003e(n||s((n={exports:{}}).exports,n),n.exports),x=(s,n)=\u003e{i(s);for(var a in n)c(s,a,{get:n[a],enumerable:!0})},b=(s,n,a)=\u003e{if(n\u0026\u0026typeof n==\"object\"||typeof n==\"function\")for(let r of o(n))!m.call(s,r)\u0026\u0026r!==\"default\"\u0026\u0026c(s,r,{get:()=\u003en[r],enumerable:!(a=h(n,r))||a.enumerable});return s},g=s=\u003eb(i(c(s!=null?d(p(s)):{},\"default\",s\u0026\u0026s.__esModule\u0026\u0026\"default\"in s?{get:()=\u003es.default,enumerable:!0}:{value:s,enumerable:!0})),s);var t=u((S,l)=\u003e{l.exports=_jsx_runtime});var k={};x(k,{default:()=\u003ev,frontmatter:()=\u003ef});var e=g(t()),f={title:\"React SSR\\uD558\\uB294 \\uC138 \\uAC00\\uC9C0 \\uBC29\\uBC95 (2)\",date:\"2020-01-14\",tags:[\"react\",\"ssr\",\"serverless\"],draft:!1,summary:\"React SSR\\uD558\\uB294 \\uB450 \\uBC88\\uC9F8 \\uBC29\\uBC95\\uC73C\\uB85C next.js, serverless-next.js\\uB97C \\uD65C\\uC6A9\\uD574\\uC11C \\uAD6C\\uD604\\uC744 \\uD574\\uBCF4\\uC558\\uB2E4.\"};function j(s={}){let{wrapper:n}=s.components||{};return n?(0,e.jsx)(n,Object.assign({},s,{children:(0,e.jsx)(a,{})})):a();function a(){let r=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",blockquote:\"blockquote\",ol:\"ol\",li:\"li\",code:\"code\",img:\"img\",h4:\"h4\",ul:\"ul\"},s.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(r.h2,{id:\"\\uCC98\\uC74C-\\uC0DD\\uAC01\\uD588\\uB358-\\uAD6C\\uD604-\\uBC29\\uD5A5\",children:[(0,e.jsx)(r.a,{href:\"#\\uCC98\\uC74C-\\uC0DD\\uAC01\\uD588\\uB358-\\uAD6C\\uD604-\\uBC29\\uD5A5\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(r.span,{className:\"icon icon-link\"})}),\"\\uCC98\\uC74C \\uC0DD\\uAC01\\uD588\\uB358 \\uAD6C\\uD604 \\uBC29\\uD5A5\"]}),(0,e.jsxs)(r.p,{children:[\"\\xA0 next.js\\uAC00 serverless target build \\uAE30\\uB2A5\\uC744 release\\uD55C \\uC9C0 \\uADF8\\uB9AC \\uC624\\uB798 \\uB418\\uC9C4 \\uC54A\\uC558\\uC9C0\\uB9CC \\uAF64 \\uC2DC\\uAC04\\uC774 \\uD758\\uB800\\uB2E4. \\uADF8\\uB54C \\uB2F9\\uC2DC\\uC5D0\\uB294 \\uAF2D \\uD55C\\uBC88 \\uC0AC\\uC6A9\\uD574\\uBD10\\uC57C\\uC9C0\\uB77C\\uB294 \\uC0DD\\uAC01\\uB9CC \\uD588\\uC5C8\\uB2E4. \\uADF8\\uB798\\uC11C \\uC774\\uBC88 \\uAE00\\uC744 \\uC368\\uC57C \\uACA0\\uB2E4\\uB77C\\uACE0 \\uB9C8\\uC74C\\uC744 \\uBA39\\uACE0 \\uBA38\\uB9BF\\uC18D\\uC73C\\uB85C \\uC5B4\\uB5BB\\uAC8C \\uAD6C\\uD604\\uD560 \\uC218 \\uC788\\uC744\\uAE4C \\uACE0\\uBBFC\\uD558\\uAE30 \\uC2DC\\uC791\\uD588\\uB54C\\uC5D0\\uB294 \\uB2E4\\uC74C\\uACFC \\uAC19\\uC774 \\uAD6C\\uD604 \\uD574\\uC57C \\uACA0\\uB2E4\\uACE0 \\uC0DD\\uAC01\\uD5C0\\uB2E4. next.js page\\uB4E4\\uC744 lambda \\uD568\\uC218\\uB85C build\\uD558\\uACE0 api-gateway\\uB97C \\uD65C\\uC6A9\\uD574\\uC11C \\uAC01 lambda\\uB4E4\\uC744 call\\uD558\\uAC8C \\uD574\\uC8FC\\uACE0, cache\\uB294 ElasticCache\\uB97C \\uD1B5\\uD574\\uC11C api \\uD639\\uC740 page\\uB97C render\\uD55C \\uACB0\\uACFC\\uBB3C\\uC744 cache\\uD558\\uB294 \\uD615\\uD0DC\\uB85C \\uAD6C\\uC131\\uD574\\uC57C\\uACA0\\uB2E4\\uB77C\\uACE0 \\uC0DD\\uAC01\\uC744 \\uD588\\uC5C8\\uB2E4. \\uADF8\\uB7F0\\uB370 \\uC9C1\\uC811 \\uCF54\\uB4DC\\uB97C \\uCE58\\uAE30 \\uC2DC\\uC791\\uD558\\uACE0 \\uC774\\uAC83 \\uC800\\uAC83 \\uAC80\\uC0C9\\uC744 \\uD558\\uB2E4 \\uBCF4\\uB2C8 \",(0,e.jsx)(r.a,{href:\"https://github.com/danielcondemarin/serverless-next.js/tree/master/packages/serverless-nextjs-component\",children:\"serverless-next.js\"}),\"\\uB77C\\uB294 \\uAC83\\uC744 \\uC54C\\uAC8C \\uB418\\uC5C8\\uB2E4. \\uB610\\uD55C \\uCE5C\\uC808\\uD558\\uAC8C \\uC18C\\uAC1C\\uB418\\uC5B4 \\uC788\\uB294 \",(0,e.jsx)(r.a,{href:\"https://serverless.com/blog/serverless-nextjs/\",children:\"\\uBE14\\uB85C\\uADF8 \\uAE00\"}),\"\\uB3C4 \\uC788\\uC5C8\\uB2E4. \\uC77D\\uC5B4 \\uBCF4\\uB2C8 \\uC774\\uB300\\uB85C \\uC2E4\\uC2B5\\uC744 \\uD574\\uBCF4\\uB294 \\uAC83\\uC774 \\uB354 \\uC88B\\uACA0\\uB2E4\\uB294 \\uC0DD\\uAC01\\uC774 \\uB4E4\\uC5C8\\uB2E4.\"]}),(0,e.jsxs)(r.h2,{id:\"\\uC2E4\\uC2B5\\uD55C-\\uACB0\\uACFC\\uBB3C-\\uACF5\\uC720-\\uBC0F-\\uB290\\uB080-\\uC810\",children:[(0,e.jsx)(r.a,{href:\"#\\uC2E4\\uC2B5\\uD55C-\\uACB0\\uACFC\\uBB3C-\\uACF5\\uC720-\\uBC0F-\\uB290\\uB080-\\uC810\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(r.span,{className:\"icon icon-link\"})}),\"\\uC2E4\\uC2B5\\uD55C \\uACB0\\uACFC\\uBB3C \\uACF5\\uC720 \\uBC0F \\uB290\\uB080 \\uC810\"]}),(0,e.jsx)(r.blockquote,{children:(0,e.jsxs)(r.ol,{children:[(0,e.jsxs)(r.li,{children:[\"nginx + react + express (with puppeteer) - \",(0,e.jsx)(r.a,{href:\"https://seonghyeonkimm.github.io/first-react-ssr/\",children:\"\\uBE14\\uB85C\\uADF8 \\uB9C1\\uD06C\"}),\" \",(0,e.jsx)(\"br\",{})]}),(0,e.jsxs)(r.li,{children:[(0,e.jsx)(r.code,{children:\"next.js\\uC758 serverless\"}),\" - \",(0,e.jsx)(r.a,{href:\"https://github.com/seonghyeonkimm/nextjs-serverless\",children:\"\\uCC38\\uACE0 repository\"}),\" \",(0,e.jsx)(\"br\",{})]}),(0,e.jsxs)(r.li,{children:[\"(coming soon) cloudFront + lambda@edge \",(0,e.jsx)(\"br\",{})]})]})}),(0,e.jsx)(r.p,{children:\"\\xA0 \\uCC98\\uC74C \\uC0DD\\uAC01\\uD588\\uB358 \\uAD6C\\uC131\\uB300\\uB85C \\uC791\\uC5C5\\uD558\\uB824\\uACE0 \\uD588\\uB2E4\\uBA74 aws\\uAD00\\uB828\\uD55C \\uACF5\\uBD80\\uB3C4 \\uB9CE\\uC774 \\uD574\\uC57C \\uD588\\uACE0 \\uAF64 \\uB9CE\\uC740 \\uC2DC\\uAC04\\uC744 \\uC368\\uC57C \\uD588\\uC744 \\uAC83\\uC774\\uB2E4. \\uADF8\\uB7F0\\uB370 \\uC2E4\\uC81C\\uB85C serverless\\uC5D0\\uC11C \\uC18C\\uAC1C\\uB418\\uACE0 \\uC788\\uB294 \\uBE14\\uB85C\\uADF8 \\uAE00\\uC744 \\uAE30\\uBC18\\uC73C\\uB85C \\uD558\\uB2E4 \\uBCF4\\uB2C8 \\uC791\\uC5C5\\uC774 \\uC0DD\\uAC01\\uBCF4\\uB2E4 \\uBE68\\uB9AC \\uB05D\\uB0AC\\uB2E4. \\uD30C\\uC77C\\uB4E4\\uC744 \\uAC70\\uC758 \\uAE30\\uBCF8 next.js application\\uACFC serverless-next.js\\uC5D0\\uC11C \\uD544\\uC694\\uD55C config \\uD30C\\uC77C \\uC815\\uB3C4 \\uBFD0\\uC774\\uB2E4. \\uADF8\\uB798\\uC11C \\uCF54\\uB4DC\\uC5D0 \\uB300\\uD55C \\uC774\\uC57C\\uAE30\\uB294 \\uD06C\\uAC8C \\uD558\\uC9C0 \\uC54A\\uC544\\uB3C4 \\uB420 \\uAC83 \\uAC19\\uACE0 serverless-next.js\\uAC00 \\uD574\\uC8FC\\uB294 \\uC804\\uCCB4\\uC801\\uC778 \\uAD6C\\uC870\\uC640 \\uAD00\\uB828\\uB41C \\uC0DD\\uAC01 \\uC815\\uB3C4\\uB9CC \\uC815\\uB9AC\\uD574 \\uBCF4\\uB824\\uACE0 \\uD55C\\uB2E4. \\uAE00\\uC758 \\uCD08\\uC785\\uBD80\\uC640 \\uAE00\\uC758 \\uB9C8\\uC9C0\\uB9C9\\uC5D0 \\uACF5\\uC720\\uD55C blog\\uAE00\\uC5D0 serverless-next.js\\uC5D0\\uC11C \\uAD6C\\uC131\\uD574\\uC8FC\\uB294 \\uAD6C\\uC870\\uB97C \\uC798 \\uADF8\\uB824 \\uB450\\uC5C8\\uB2E4. \\uD574\\uB2F9 \\uC774\\uBBF8\\uC9C0\\uB97C \\uC544\\uB798\\uB85C \\uC62E\\uACA8 \\uC640 \\uBCF4\\uC558\\uB2E4.\"}),(0,e.jsx)(r.p,{children:(0,e.jsx)(r.img,{alt:\"second-react-ssr-diagram\",src:\"https://s3-us-west-2.amazonaws.com/assets.blog.serverless.com/serverless-nextjs/serverless_nextjs_lambda_edge_aws_architecture.png\"})}),(0,e.jsxs)(r.p,{children:[\"\\xA0 \\uC704\\uC758 \\uADF8\\uB9BC\\uC744 \\uAC04\\uB2E8\\uD788\\uB9CC \\uAE00\\uB85C \\uC124\\uBA85\\uD55C\\uB514\\uBA74, user\\uAC00 \\uB3C4\\uBA54\\uC778\\uC744 \\uC785\\uB825\\uD558\\uAC8C \\uB418\\uBA74 cloudFront\\uB85C \\uC694\\uCCAD\\uC774 \\uC804\\uB2EC\\uB418\\uACE0 build assets, user assets\\uC758 \\uC694\\uCCAD \\uAC19\\uC740 \\uACBD\\uC6B0\\uC5D0\\uB294 \\uBC14\\uB85C s3\\uB85C \\uC804\\uB2EC \\uB418\\uC5B4 \\uD30C\\uC77C\\uC774 return\\uB41C\\uB2E4. \\uADF8 \\uC774\\uC678\\uC758 \\uC815\\uC801\\uC778 \",(0,e.jsx)(r.code,{children:\".html\\uB85C \\uB9CC\\uB4E4\\uC5B4 \\uC9C4 \\uD398\\uC774\\uC9C0, /manifest.json, /robot.txt\\uC640 \\uAC19\\uC740 public assest, ssr\\uC774 \\uD544\\uC694\\uD55C page\\uC5D0 \\uB300\\uD55C \\uC694\\uCCAD, \\uADF8\\uB9AC\\uACE0 api \\uC694\\uCCAD\\uC740 lambda@edge\\uB85C \\uC804\\uB2EC\\uB418\\uC5B4 \\uAC01 \\uC694\\uCCAD\\uC5D0 \\uB9DE\\uAC8C \\uCC98\\uB9AC\\uB418\\uC5B4 return\"}),\"\\uB41C\\uB2E4. public asset\\uC774\\uB098 getInitialProps\\uAC00 \\uC0AC\\uC6A9\\uB418\\uC9C0 \\uC54A\\uC544\\uC11C \",(0,e.jsx)(r.code,{children:\".html\\uD30C\\uC77C\\uB85C \\uB9CC\\uB4E4\\uC5B4\\uC9C4 \\uD30C\\uC77C\\uB3C4 lambda\\uB97C \\uD1B5\\uD55C \\uB2E4\\uB294 \\uAC83\\uC774 \\uB9C8\\uC74C\\uC5D0 \\uB4E4\\uC9C0 \\uC54A\\uC558\\uACE0 \\uAD73\\uC774 \\uADF8\\uB7F4 \\uD544\\uC694\\uAC00 \\uC788\\uB098 \\uC0DD\\uAC01\\uC774 \\uB4E4\\uC5C8\\uB2E4. \\uC5ED\\uC2DC\\uB294 \\uC5ED\\uC2DC. \\uC774\\uC720\\uAC00 \\uC788\\uC5C8\\uB2E4.\"}),\" cloudFront\\uC5D0\\uC11C cache\\uC5D0 \\uB300\\uD55C rule\\uC744 \\uCD5C\\uB300 25\\uAC1C\\uAE4C\\uC9C0\\uB9CC \\uB9CC\\uB4E4 \\uC218 \\uC788\\uAE30 \\uB54C\\uBB38\\uC774\\uC5C8\\uB2E4. \\uC774 \\uBD80\\uBD84\\uB9CC \\uD574\\uACB0\\uD560 \\uC218 \\uC788\\uB294 \\uBC29\\uBC95\\uC774 \\uC788\\uB2E4\\uBA74 \\uD6E8\\uC52C \\uC88B\\uACA0\\uB2E4\\uB77C\\uB294 \\uC0DD\\uAC01\\uC744 \\uD588\\uB2E4. \\uC544\\uC26C\\uC6E0\\uB2E4.\"]}),(0,e.jsxs)(r.p,{children:[\"\\xA0 \\uB2E4\\uC74C\\uC73C\\uB85C, \\uC911\\uC694 \\uD558\\uAE30\\uB3C4 \\uD558\\uACE0 \\uC8FC\\uBAA9\\uD560 \\uB9CC \\uD588\\uB358 \\uBD80\\uBD84\\uC774 cache\\uC640 \\uAD00\\uB828\\uB41C \\uBD80\\uBD84\\uC774\\uC5C8\\uB2E4. \",(0,e.jsx)(r.code,{children:\"SSR\\uC744 \\uD558\\uAC8C \\uB418\\uBA74 api \\uC694\\uCCAD\\uC5D0 \\uB300\\uD55C \\uACB0\\uACFC\\uB97C \\uBC1B\\uACE0 page\\uB97C render\\uD558\\uACE0 \\uB0B4\\uB9AC\\uB294 \\uACFC\\uC815\\uC774 \\uC120\\uD589 \\uB418\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uB2E8\\uC21C\\uD788 index.html\\uC744 \\uBC1B\\uB294 \\uACFC\\uC815\\uBCF4\\uB2E4 \\uC624\\uB798 \\uAC78\\uB9B0\\uB2E4. \\uADF8\\uB798\\uC11C cache\\uB97C \\uC798\\uD558\\uB294 \\uAC83\\uC774 \\uC571\\uC758 \\uD37C\\uD3EC\\uBA3C\\uC2A4\\uC5D0 \\uAD49\\uC7A5\\uD788 \\uC9C0\\uB300\\uD55C \\uC601\\uD5A5\\uC744 \\uB07C\\uCE5C\\uB2E4.\"}),\" serverless-next.js\\uB294 \\uD06C\\uAC8C\\uB294 \\uB450 \\uAC00\\uC9C0 \\uAE30\\uBCF8 cache \\uC815\\uCC45\\uC744 \\uAC00\\uC9C0\\uACE0 \\uC788\\uB2E4. \",(0,e.jsx)(r.code,{children:\"\\uCCAB \\uBC88\\uC9F8\\uB85C, build assets, user assets\\uC740 hash\\uAC12\\uACFC \\uD568\\uAED8 \\uD30C\\uC77C \\uC774\\uB984\\uC774 \\uC0DD\\uC131\\uB418\\uAE30 \\uB54C\\uBB38\\uC5D0 cache TTL\\uC774 max\\uAC12\\uC73C\\uB85C \\uC124\\uC815\"}),\" \\uB418\\uC5B4 \\uC788\\uB2E4. \",(0,e.jsx)(r.code,{children:\"\\uB450 \\uBC88\\uC9F8\\uB85C lambda\\uC5D0 \\uB300\\uD55C cache \\uC815\\uCC45\\uC740 \\uC9C1\\uC811 \\uBCC0\\uACBD \\uD558\\uC9C0 \\uC54A\\uB294 \\uB2E4\\uBA74 \\uAE30\\uBCF8\\uC801\\uC73C\\uB85C\\uB294 cache\\uB97C \\uD558\\uC9C0 \\uC54A\\uB294\\uB2E4.\"})]}),(0,e.jsxs)(r.p,{children:[\"\\xA0 lambda\\uC5D0 \\uB300\\uD55C cache \\uC815\\uCC45\\uC5D0 \\uB300\\uD574\\uC11C\\uB294 \\uC2A4\\uC2A4\\uB85C \\uC880 \\uB354 \\uC2E0\\uACBD\\uC368\\uC57C \\uD560 \\uBD80\\uBD84\\uC774\\uB77C\\uACE0 \\uC0DD\\uAC01\\uC774 \\uB4E0\\uB2E4. \\uAE30\\uBCF8 \\uC124\\uC815\\uC744 \\uAC00\\uC9C0\\uACE0 \\uACC4\\uC18D \\uC791\\uC5C5 \\uD558\\uAE30 \\uBCF4\\uB2E4\\uB294 \",(0,e.jsx)(r.code,{children:\"\\uC608\\uB97C \\uB4E4\\uC5B4\\uC11C 1\\uC2DC\\uAC04 \\uC815\\uB3C4\\uB294 \\uCD5C\\uC18C\\uD55C cache\\uD558\\uB3C4\\uB85D \\uC124\\uC815\\uC744 \\uBCC0\\uACBD\\uD558\\uC5EC \\uC0AC\\uC6A9\\uD558\\uB294 \\uAC83\\uC774 \\uBC14\\uB78C\\uC9C1\\uD558\\uC9C0 \\uC54A\\uC744\\uAE4C \\uC2F6\\uB2E4.\"}),\" \\uADF8\\uB9AC\\uACE0 \\uBC30\\uD3EC\\uD558\\uAC70\\uB098 \\uD639\\uC740 \",(0,e.jsx)(r.code,{children:\"cache invalidate\\uAC00 \\uD544\\uC694\\uD560 \\uB54C\\uC5D0\\uB294 cloudFront\\uC758 invalidation \\uAE30\\uB2A5\\uC744 \\uC0AC\\uC6A9 \\uD55C\\uB2E4\\uBA74 \\uC571 \\uC131\\uB2A5\\uBA74\\uC5D0 \\uC788\\uC5B4\\uC11C \\uD6E8\\uC52C \\uB3C4\\uC6C0\\uC774 \\uB420 \\uAC70\\uB77C\\uB294 \\uC0DD\\uAC01\\uC774 \\uB4E4\\uC5C8\\uB2E4.\"}),\" \\uBB3C\\uB860 cache\\uB97C \\uD560 \\uB54C\\uC5D0 \\uB85C\\uADF8\\uC778 \\uC5EC\\uBD80, device, language\\uB4F1\\uACFC \\uAD00\\uB828\\uD558\\uC5EC \",(0,e.jsx)(r.code,{children:\"api data\\uB098 page\\uAC00 \\uBCC0\\uACBD\\uB420 \\uC18C\\uC9C0\\uAC00 \\uC788\\uB294 \\uBD80\\uBD84\\uC5D0 \\uB300\\uD574\\uC11C\\uB294 \\uC798 \\uACE0\\uB824 \\uD558\\uC5EC cache \\uC815\\uCC45\\uC744 \\uC138\\uC6CC\\uC57C \\uD55C\\uB2E4.\"}),\" \\uC544\\uB9C8 \\uB2E4\\uB978 \\uB354 \\uC88B\\uC740 \\uBC29\\uC2DD\\uC774 \\uC788\\uC744 \\uC218 \\uC788\\uB2E4. \\uB354 \\uC88B\\uC740 cache \\uC804\\uB7B5\\uC5D0 \\uB300\\uD574\\uC120 \\uACF5\\uBD80\\uAC00 \\uB354 \\uD544\\uC694\\uD560 \\uB4EF \\uD558\\uB2E4. \\uBB3C\\uB860, \\uC2E4\\uC81C\\uB85C \\uC11C\\uBE44\\uC2A4\\uB97C \\uD558\\uB2E4 \\uBCF4\\uBA74 infra\\uAD00\\uB828\\uB418\\uC5B4\\uC11C\\uB4E0 application\\uAD00\\uB828 \\uB418\\uC5B4\\uC11C\\uB4E0 \\uBD84\\uBA85\\uD788 \\uB354 \\uB9CE\\uC740 \\uBB38\\uC81C\\uB4E4\\uC744 \\uB9C8\\uC8FC\\uD558\\uAC8C \\uB418\\uACA0\\uC9C0\\uB9CC, \\uC2E4\\uC2B5 \\uD558\\uBA74\\uC11C \\uB290\\uAF08\\uB358 \\uC810\\uC740 \\uC774 \\uC815\\uB3C4\\uC774\\uB2E4.\"]}),(0,e.jsxs)(r.h2,{id:\"\\uC2A4\\uC2A4\\uB85C-\\uC0DD\\uAC01\\uD574\\uBCF4\\uB294-\\uC7A5\\uB2E8\\uC810-\\uBC0F-\\uACB0\\uB860\",children:[(0,e.jsx)(r.a,{href:\"#\\uC2A4\\uC2A4\\uB85C-\\uC0DD\\uAC01\\uD574\\uBCF4\\uB294-\\uC7A5\\uB2E8\\uC810-\\uBC0F-\\uACB0\\uB860\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(r.span,{className:\"icon icon-link\"})}),\"\\uC2A4\\uC2A4\\uB85C \\uC0DD\\uAC01\\uD574\\uBCF4\\uB294 \\uC7A5\\uB2E8\\uC810 \\uBC0F \\uACB0\\uB860\"]}),(0,e.jsxs)(r.h4,{id:\"\\uC7A5\\uC810\",children:[(0,e.jsx)(r.a,{href:\"#\\uC7A5\\uC810\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(r.span,{className:\"icon icon-link\"})}),\"\\uC7A5\\uC810\"]}),(0,e.jsxs)(r.ul,{children:[(0,e.jsx)(r.li,{children:\"react SSR\\uD558\\uBA74 next.js\\uC774\\uB2E4. react\\uC5D0\\uC11C \\uACF5\\uC2DD\\uC801\\uC73C\\uB85C \\uCD94\\uCC9C \\uD558\\uACE0 \\uC788\\uB2E4.\"}),(0,e.jsx)(r.li,{children:\"next.js\\uD300\\uC774 \\uC9C4\\uC9DC \\uC5F4\\uC2EC\\uD788 \\uC77C\\uD55C\\uB2E4. \\uAC1C\\uC120\\uC758 \\uCCB4\\uAC10\\uC18D\\uB3C4 \\uC9C4\\uC9DC \\uBE60\\uB974\\uB2E4.\"}),(0,e.jsx)(r.li,{children:\"serverless\\uB77C\\uB294 \\uC810\\uC5D0\\uC11C infra\\uAD00\\uB9AC\\uC5D0 \\uC788\\uC5B4\\uC11C \\uC9C1\\uC811 \\uC11C\\uBC84\\uB97C \\uB744\\uC6B0\\uB294 \\uAC83\\uBCF4\\uB2E4 traffic\\uAD00\\uB9AC\\uC5D0 \\uC788\\uC5B4\\uC11C \\uC880 \\uB35C \\uC2E0\\uACBD\\uC368\\uB3C4 \\uB41C\\uB2E4.\"})]}),(0,e.jsxs)(r.h4,{id:\"\\uB2E8\\uC810\",children:[(0,e.jsx)(r.a,{href:\"#\\uB2E8\\uC810\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(r.span,{className:\"icon icon-link\"})}),\"\\uB2E8\\uC810\"]}),(0,e.jsxs)(r.ul,{children:[(0,e.jsx)(r.li,{children:\"lambda\\uB3C4 \\uACB0\\uAD6D\\uC740 \\uC11C\\uBC84\\uB2E4. \\uB9CE\\uC740 traffic\\uC774 \\uBAB0\\uB9B4 \\uACBD\\uC6B0\\uC5D0 \\uB3D9\\uC2DC \\uCC98\\uB9AC\\uC758 \\uC218\\uC5D0 \\uC81C\\uD55C\\uC774 \\uC788\\uB2E4. \\uBB3C\\uB860 \\uD574\\uACB0\\uD560 \\uC218 \\uC788\\uB294 \\uBC29\\uBC95\\uC774\\uC57C \\uC788\\uB2E4. \\uADF8\\uB7EC\\uBBC0\\uB85C infra\\uC5D0 \\uB300\\uD55C \\uAD00\\uB9AC\\uAC00 \\uC5EC\\uC804\\uD788 \\uD544\\uC694\\uD558\\uB2E4.\"}),(0,e.jsxs)(r.li,{children:[\"SPA\\uB77C\\uBA74 \\uAD73\\uC774 server\\uB85C traffic\\uC744 \\uC804\\uB2EC\\uD558\\uC9C0 \\uC54A\\uC544\\uB3C4 \\uB418\\uB294 \",(0,e.jsx)(r.code,{children:\"/*.html\"}),\", \",(0,e.jsx)(r.code,{children:\"/robots.txt\"}),\"\\uB4F1\\uC758 static\\uD55C \\uD30C\\uC77C\\uB3C4 lambda\\uB97C \\uD1B5\\uD574\\uC57C \\uD55C\\uB2E4.\"]}),(0,e.jsx)(r.li,{children:\"cache\\uAC00 \\uD544\\uC694\\uD558\\uACE0 \\uACE0\\uB824\\uD560 \\uAC83\\uB4E4\\uC774 \\uAF64 \\uB9CE\\uB2E4. \\uC2E4\\uC81C\\uB85C user\\uC640 bot\\uC774 \\uC0AC\\uC6A9\\uD558\\uB294 \\uACB0\\uACFC\\uBB3C\\uC774 \\uC77C\\uCE58\\uD558\\uBBC0\\uB85C, cache\\uD560 \\uB54C\\uC5D0 \\uC2E0\\uACBD\\uC368\\uC57C \\uD560 \\uAC83\\uC774 \\uC880 \\uB354 \\uB9CE\\uB2E4. \\uC608\\uB97C \\uB4E4\\uBA74 user\\uC758 language, device, \\uB85C\\uADF8\\uC778 \\uC5EC\\uBD80\\uB4E4\\uC744 \\uC11C\\uBC84 \\uCE21\\uC5D0\\uC11C \\uCC98\\uB9AC \\uD558\\uACE0 \\uCE90\\uC2DC\\uAC00 \\uB41C\\uB2E4\\uBA74 \\uC608\\uAE30\\uCE58 \\uBABB\\uD55C \\uC5D0\\uB7EC\\uB97C \\uB9CC\\uB0A0 \\uC218 \\uC788\\uB2E4.\"})]}),(0,e.jsxs)(r.p,{children:[\"\\xA0 \\uACB0\\uB860\\uC801\\uC73C\\uB85C, \",(0,e.jsx)(r.code,{children:\"SSR\\uC774 \\uD544\\uC694\\uD558\\uACE0 cloudFront\\uB97C \\uC0AC\\uC6A9\\uD558\\uC5EC \\uC11C\\uBE44\\uC2A4\\uD560 \\uC218 \\uC788\\uB294 \\uC0C1\\uD669\\uC774\\uB77C\\uBA74 \\uC0AC\\uC6A9\\uC744 \\uACE0\\uB824 \\uD574\\uBCF4\\uC544\\uB3C4 \\uC88B\\uB2E4\\uB294 \\uC0DD\\uAC01\\uC774 \\uB4E0\\uB2E4.\"}),\" \\uC9C1\\uC811 infra\\uB97C \\uAD6C\\uD604\\uD558\\uB294 \\uAC83\\uBCF4\\uB2E4 \\uD6E8\\uC52C \\uAC04\\uD3B8\\uD558\\uB2E4. \\uBB3C\\uB860, \\uC774\\uBBF8 infra\\uAD00\\uB9AC\\uC5D0 \\uC775\\uC219\\uD55C \\uC0AC\\uB78C\\uC774\\uB77C\\uBA74 \\uB9D0\\uC774 \\uB2E4\\uB974\\uACA0\\uC9C0\\uB9CC. \\uB2E4\\uB9CC \\uB610 \\uB2E8\\uC810\\uACFC \\uBCF4\\uC644\\uC774 \\uD544\\uC694\\uD55C \\uBB38\\uC81C\\uB4E4\\uB3C4 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uADF8\\uB7F0 \\uBD80\\uBD84\\uC5D0 \\uB300\\uD55C \\uACE0\\uB824\\uC640 \\uBC29\\uC548\\uB4E4\\uC744 \\uAC16\\uCD94\\uACE0 \\uC788\\uB2E4\\uBA74 \\uB354\\uD560 \\uB098\\uC704 \\uC5C6\\uC774 \\uC88B\\uC740 \\uC120\\uD0DD\\uC774 \\uB420 \\uC218\\uB3C4 \\uC788\\uB2E4\\uACE0 \\uC0DD\\uAC01\\uD55C\\uB2E4.\"]}),(0,e.jsxs)(r.h2,{id:\"\\uCC38\\uACE0\\uD55C-\\uAE00\",children:[(0,e.jsx)(r.a,{href:\"#\\uCC38\\uACE0\\uD55C-\\uAE00\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(r.span,{className:\"icon icon-link\"})}),\"\\uCC38\\uACE0\\uD55C \\uAE00\"]}),(0,e.jsxs)(r.ul,{children:[(0,e.jsx)(r.li,{children:(0,e.jsx)(r.a,{href:\"https://nextjs.org\",children:\"https://nextjs.org\"})}),(0,e.jsx)(r.li,{children:(0,e.jsx)(r.a,{href:\"https://serverless.com/blog/serverless-nextjs\",children:\"https://serverless.com/blog/serverless-nextjs\"})})]})]})}}var v=j;return k;})();\n;return Component;"},"_id":"blog/second-react-ssr.mdx","_raw":{"sourceFilePath":"blog/second-react-ssr.mdx","sourceFileName":"second-react-ssr.mdx","sourceFileDir":"blog","contentType":"mdx","flattenedPath":"blog/second-react-ssr"},"type":"Blog","readingTime":{"text":"4 min read","minutes":3.535,"time":212100,"words":707},"slug":"second-react-ssr","toc":[{"value":"처음 생각했던 구현 방향","url":"#처음-생각했던-구현-방향","depth":2},{"value":"실습한 결과물 공유 및 느낀 점","url":"#실습한-결과물-공유-및-느낀-점","depth":2},{"value":"스스로 생각해보는 장단점 및 결론","url":"#스스로-생각해보는-장단점-및-결론","depth":2},{"value":"장점","url":"#장점","depth":4},{"value":"단점","url":"#단점","depth":4},{"value":"참고한 글","url":"#참고한-글","depth":2}]},"authorDetails":[{}],"prev":{"title":"React SSR하는 세 가지 방법 (1)","date":"2020-01-07T00:00:00.000Z","tags":["react","ssr","nginx","prerender"],"draft":false,"summary":"React SSR을 어떻게 하는 것이 가장 합리적일까. 현재 나의 지식 안에서 가장 합리적이라고 생각하는 총 3가지 중 첫 번째에 대한 내용을 정리했다.","type":"Blog","readingTime":{"text":"4 min read","minutes":3.64,"time":218400,"words":728},"slug":"first-react-ssr","toc":[{"value":"Next.js를 사용해서 SSR을 하면서 부딪힌 문제 상황","url":"#nextjs를-사용해서-ssr을-하면서-부딪힌-문제-상황","depth":2},{"value":"새로운 SSR방식 시도","url":"#새로운-ssr방식-시도","depth":2},{"value":"스스로 생각해보는 장단점 및 결론","url":"#스스로-생각해보는-장단점-및-결론","depth":2},{"value":"장점","url":"#장점","depth":4},{"value":"단점","url":"#단점","depth":4},{"value":"참고한 글","url":"#참고한-글","depth":2}]},"next":{"title":"2020년 반이 지나간 자리","date":"2020-07-05T00:00:00.000Z","tags":["retrospection"],"draft":false,"summary":"2020년 반이 지나간 자리에 어떤 것이 남아 있는가","type":"Blog","readingTime":{"text":"5 min read","minutes":4.525,"time":271500,"words":905},"slug":"2020-self-retrospection","toc":[{"value":"느끼고 기록하고 나누는 삶을 지향하자","url":"#느끼고-기록하고-나누는-삶을-지향하자","depth":2},{"value":"유용한 가치 구축을 통한 자본에 종속되지 않는 삶","url":"#유용한-가치-구축을-통한-자본에-종속되지-않는-삶","depth":2}]}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["second-react-ssr"]},"buildId":"6Krvmak2ov-qcCHuSyM4j","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>