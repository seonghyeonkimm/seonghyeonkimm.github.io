<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.5f81339daa9828444137.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}</style><meta name="generator" content="Gatsby 2.18.12"/><title data-react-helmet="true">React SSR하는 세 가지 방법 (2) | Seonghyeon kim</title><link data-react-helmet="true" rel="icon" href="data:image/vnd.microsoft.icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEdklEQVRYR8WXWWxUZRTH/+fe2bfutEinpu1MIVKpKIttUcDUxKoNakJM6ZAYQ3wwSCTGJfHFJxMNMUokxhgTsK01VKpBw4Mm2ECNLIEHy4NmWkBaCsaus09n7j3mu+0Mtc7MbWkbvsc73znnd/ZvCPf40D22j2UHYH/b6yDaCkn9jKq+PqPn4LIAMO+WiboVvtLaCquhEywc4wDM8TJyd0dzQSwJgHmHAQPlJ0DUDKAneGFss2NzYRWRpjYBVovJ2xlYMYDY6ecPmCscn6QMhC6Nw1rjhOw0ik+nyNP+zIqmYPJYc7+roah21mPER6JQggnY1roAlfdQTUfXigJMHGk67thStNtQYNLscFJF8NwYXI3FU7DEV+vlX8gsqQbGjzzRYnY7TtoeyEs7Gu6fFCn40trUs0/P+yUD8OePGKekopuux1eVkDzjS2IsjvDF0e0F+0/rtuCSAYSCiU+bDts25r9mKrXOOswMJO8nzzdDKx4BYSDc/fQuFdL3jo0Fd+wxv0Pejg+WHYD9vh0gPAnGCfJ2XNYKz+/7IvDb6D7HpiJIJill8wp52h9cVoBIT8tB64Z84ZVo8iASoUpY8sJQlFvRwWA+mSRY3PY7aWBsSkHe1SBi/4vVIOMhIRy7HjisTPHP9rp8eU6cGyHRGqg4rkSSiPRPwbmlEJiZggDjY/K2H9SLQtY25AHfdwA9JxQoE/HbsRvRMntd/hx96jYwvc1Ai/gYujgO2/o8yLZZRqLbGBpy087e5N1FYMDXB1CjEE6OxxEfiiIFwMwIX574VgkkdkEmbe6mT8ol1sJwKO/ln94SmykbRK4IZAWYHoli+u8Y7BvyQHK68P5ng1UGTytvyLVdHy0rgJh2pvusMBaZ9VIsZu0tVLWXE0HNdDl7BPy+X0HUIIQSIgU3InA8NNPr0cGgNsWt1Q59AC0Taj15O88tCiB25oWz5tX2bZrBgSCmhyNwNpRAMktITk4jdGEchlVmSJY5jTFrwVxhg2wzzLHH75On491FAQS+eqoXRmm7Vj4SwVRmQfxaGJJdhhpRYF3n0nqNFUCNJRHzh2Ass2hpMZaYQYb/1Mbv5GmvWxSA6vedVMNKi9iXkk2G2Pli3aoxBZJVThcfKyqC58dgqXbCVGrJnBKCAsSKqLp7av6FXF3wIUBv6iVZpEdUu61GRCTHScaqaF33tYUD/NnWDFk6lUunMBzo+wfO+mJIxuztCEYCBtlFlUdjCwfgV4wYjAriNdkgRDHGrobgeLhQJ1DcR56OxxZVA1r3DOw5AMjpR+d8BfGbkZmC9Dp1ANSXyNN5bPEAv+wwwF1+FqBHMwnHhyNa/i0VqS2Y6RZfQnV8q/jfsGgALQqDeyvA6APgnq9A7ARxUq/iDAYmoSTraW3XH9lCtKBHKV/fW4mE+gNIWq/XFenfmUfB9CzVtJ/PJbMgAC0SIy02RPLeA7AfoNQDMINuZjB+BPhV8nYO6wEvGCCliK+2lkKR20DcDEi1IC4BUwLgvwD0gvlotrmfCeZfkDuwMDkFxawAAAAASUVORK5CYII="/><meta data-react-helmet="true" name="description" content="React SSR하는 두 번째 방법으로 next.js, serverless-next.js를 활용해서 구현을 해보았다."/><meta data-react-helmet="true" property="og:title" content="React SSR하는 세 가지 방법 (2)"/><meta data-react-helmet="true" property="og:description" content="React SSR하는 두 번째 방법으로 next.js, serverless-next.js를 활용해서 구현을 해보았다."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Seonghyeon Kim"/><meta data-react-helmet="true" name="twitter:title" content="React SSR하는 세 가지 방법 (2)"/><meta data-react-helmet="true" name="twitter:description" content="React SSR하는 두 번째 방법으로 next.js, serverless-next.js를 활용해서 구현을 해보았다."/><link as="script" rel="preload" href="/webpack-runtime-9816a3b5d482d94d8ad0.js"/><link as="script" rel="preload" href="/styles-2c35f9c047bc332cf9af.js"/><link as="script" rel="preload" href="/app-af738798f5ab42d39990.js"/><link as="script" rel="preload" href="/commons-37167ceaf9054f7f6325.js"/><link as="script" rel="preload" href="/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-b2dbbaec7db33016a868.js"/><link as="fetch" rel="preload" href="/page-data/second-react-ssr/page-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
        var mode = localStorage.getItem('theme-ui-color-mode');
        if (!mode) return
        document.body.classList.add('theme-ui-' + mode);
      } catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="ve0mxe">body{--theme-ui-colors-text:var(--theme-ui-colors-text,#232129);--theme-ui-colors-background:var(--theme-ui-colors-background,#fff);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#663399);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#1B1F23);--theme-ui-colors-muted:var(--theme-ui-colors-muted,hsla(0,0%,0%,0.2));--theme-ui-colors-highlight:var(--theme-ui-colors-highlight,rgba(255,229,100,0.2));--theme-ui-colors-heading:var(--theme-ui-colors-heading,#232129);--theme-ui-colors-prism-background:var(--theme-ui-colors-prism-background,#011627);--theme-ui-colors-prism-comment:var(--theme-ui-colors-prism-comment,#809393);--theme-ui-colors-prism-string:var(--theme-ui-colors-prism-string,#addb67);--theme-ui-colors-prism-var:var(--theme-ui-colors-prism-var,#d6deeb);--theme-ui-colors-prism-number:var(--theme-ui-colors-prism-number,#f78c6c);--theme-ui-colors-prism-constant:var(--theme-ui-colors-prism-constant,#82aaff);--theme-ui-colors-prism-punctuation:var(--theme-ui-colors-prism-punctuation,#c792ea);--theme-ui-colors-prism-className:var(--theme-ui-colors-prism-className,#ffc98b);--theme-ui-colors-prism-tag:var(--theme-ui-colors-prism-tag,#ffa7c4);--theme-ui-colors-prism-boolean:var(--theme-ui-colors-prism-boolean,#ff5874);--theme-ui-colors-prism-property:var(--theme-ui-colors-prism-property,#80cbc4);--theme-ui-colors-prism-namespace:var(--theme-ui-colors-prism-namespace,#b2ccd6);--theme-ui-colors-prism-highlight:var(--theme-ui-colors-prism-highlight,hsla(207,95%,15%,1));color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#232129));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fff));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,rgba(255,255,255,0.86));--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#232129);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#D9BAE8);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,rgba(255,255,255,0.86));--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,hsla(0,0%,100%,0.2));--theme-ui-colors-highlight:var(--theme-ui-colors-modes-dark-highlight,#663399);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);}</style><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><style data-emotion-css="16mk19i">.css-16mk19i{font-family:'Merriweather','Georgia',serif;font-size:16px;font-weight:400;line-height:1.75;}</style><div class="css-16mk19i"><header><style data-emotion-css="nvo7eq">.css-nvo7eq{max-width:672px;margin-left:auto;margin-right:auto;padding-left:28px;padding-right:28px;padding-top:56px;}</style><div class="css-nvo7eq"><style data-emotion-css="2a1trj">.css-2a1trj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:56px;}</style><div class="css-2a1trj"><style data-emotion-css="1qd1r5f">.css-1qd1r5f{margin-top:0;margin-bottom:0;}</style><style data-emotion-css="9ngr65">.css-9ngr65{padding:0;margin:0;margin-bottom:28px;font-size:23.08319849451542px;font-family:Montserrat,sans-serif;line-height:1.1;font-weight:900;margin-top:0;margin-bottom:0;}</style><p class="css-9ngr65"><style data-emotion-css="mhwttb">.css-mhwttb{box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary,#663399);}</style><style data-emotion-css="1617ngy">.css-1617ngy{color:var(--theme-ui-colors-primary,#663399);box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary,#663399);}</style><a class="css-1617ngy" href="/">Seonghyeon kim</a></p><div style="position:relative;display:inline-block;text-align:left;opacity:1;direction:ltr;border-radius:12px;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s;touch-action:none;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none"><div class="react-switch-bg" style="height:24px;width:48px;margin:0;position:relative;background:#000000;border-radius:12px;cursor:pointer;-webkit-transition:background 0.25s;-moz-transition:background 0.25s;transition:background 0.25s"><div style="height:24px;width:25px;position:relative;opacity:0;pointer-events:none;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s"><style data-emotion-css="h5g4ul">.css-h5g4ul{margin:4px;}.css-h5g4ul function (props){-webkit-var:theme = _extends({},defaultTheme,{},props.theme || props);-moz-var:theme = _extends({},defaultTheme,{},props.theme || props);-ms-var:theme = _extends({},defaultTheme,{},props.theme || props);var:theme = _extends({},defaultTheme,{},props.theme || props);-webkit-var obj = typeof args === 'function' ? args(theme) :args;-moz-var obj = typeof args === 'function' ? args(theme) :args;-ms-var obj = typeof args === 'function' ? args(theme) :args;var obj = typeof args === 'function' ? args(theme) :args;-webkit-var:styles = responsive(obj)(theme);-moz-var:styles = responsive(obj)(theme);-ms-var:styles = responsive(obj)(theme);var:styles = responsive(obj)(theme);return:result;}.css-h5g4ul function (props) for (var key in styles){-webkit-var:x = styles[key];-moz-var:x = styles[key];-ms-var:x = styles[key];var:x = styles[key];-webkit-var val = typeof x === 'function' ? x(theme) :x;-moz-var val = typeof x === 'function' ? x(theme) :x;-ms-var val = typeof x === 'function' ? x(theme) :x;var val = typeof x === 'function' ? x(theme) :x;-webkit-var:prop = get(aliases,key,key);-moz-var:prop = get(aliases,key,key);-ms-var:prop = get(aliases,key,key);var:prop = get(aliases,key,key);-webkit-var:scaleName = get(scales,prop);-moz-var:scaleName = get(scales,prop);-ms-var:scaleName = get(scales,prop);var:scaleName = get(scales,prop);-webkit-var:scale = get(theme,scaleName,get(theme,prop,{}));-moz-var:scale = get(theme,scaleName,get(theme,prop,{}));-ms-var:scale = get(theme,scaleName,get(theme,prop,{}));var:scale = get(theme,scaleName,get(theme,prop,{}));-webkit-var:transform = get(transforms,prop,get);-moz-var:transform = get(transforms,prop,get);-ms-var:transform = get(transforms,prop,get);var:transform = get(transforms,prop,get);-webkit-var:value = transform(scale,val,val);-moz-var:value = transform(scale,val,val);-ms-var:value = transform(scale,val,val);var:value = transform(scale,val,val);}.css-h5g4ul function (props) for (var key in styles) if (key === 'variant'){-webkit-var:variant = css(get(theme,val))(theme);-moz-var:variant = css(get(theme,val))(theme);-ms-var:variant = css(get(theme,val))(theme);var:variant = css(get(theme,val))(theme);result:= _extends({},result,{},variant);continue;}if (val .css-h5g4ul function (props) for (var key in styles).css-h5g4ul function (props) for (var key in styles) typeof val === 'object'){result[key]:= css(val)(theme);continue;}.css-h5g4ul function (props) for (var key in styles) if (multiples[prop]){-webkit-var:dirs = multiples[prop];-moz-var:dirs = multiples[prop];-ms-var:dirs = multiples[prop];var:dirs = multiples[prop];}.css-h5g4ul function (props) for (var key in styles) if (multiples[prop]) for (var i = 0; i < dirs.length; i++){result[dirs[i]]:= value;}.css-h5g4ul function (props) for (var key in styles) else{result[prop]:= value;}</style><img alt="moon indicating dark mode" src="data:image/png;base64,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" width="16" height="16" role="presentation" class="css-h5g4ul"/></div><div style="height:24px;width:25px;position:absolute;opacity:1;right:0;top:0;pointer-events:none;-webkit-transition:opacity 0.25s;-moz-transition:opacity 0.25s;transition:opacity 0.25s"><img alt="sun indicating light mode" src="data:image/png;base64,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" width="16" height="16" role="presentation" class="css-h5g4ul"/></div></div><div class="react-switch-handle" style="height:24px;width:24px;background:#ffffff;display:inline-block;cursor:pointer;border-radius:50%;position:absolute;transform:translateX(0px);top:0;outline:0;box-shadow:inset 0 0 0 1px #000;border:0;-webkit-transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s;-moz-transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s;transition:background-color 0.25s, transform 0.25s, box-shadow 0.15s"></div><input type="checkbox" role="switch" style="border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px" aria-label="Toggle dark mode"/></div></div></div></header><div><style data-emotion-css="1ewmu01">.css-1ewmu01{max-width:672px;margin-left:auto;margin-right:auto;padding-left:28px;padding-right:28px;padding-top:56px;padding-bottom:56px;}</style><div class="css-1ewmu01"><main><style data-emotion-css="11b9pc1">.css-11b9pc1{padding:0;margin:0;margin-bottom:28px;font-size:40px;font-family:Montserrat,sans-serif;line-height:1.1;font-weight:900;}</style><h1 class="css-11b9pc1">React SSR하는 세 가지 방법 (2)</h1><style data-emotion-css="1qqxfhy">.css-1qqxfhy{font-size:13.32085131842997px;margin-top:-28px;margin-bottom:28px;}</style><style data-emotion-css="1m60b3c">.css-1m60b3c{padding:0;margin:0;margin-bottom:28px;font-size:13.32085131842997px;margin-top:-28px;margin-bottom:28px;}.css-1m60b3c code{font-size:inherit;}</style><p class="css-1m60b3c">January 14, 2020</p><style data-emotion-css="psov1g">.css-psov1g{padding:0;margin:0;margin-bottom:28px;font-size:27.725793726205858px;font-family:Montserrat,sans-serif;line-height:1.1;font-weight:900;}</style><style data-emotion-css="1ieeh81">.css-1ieeh81{pointer-events:painted;padding:0;margin:0;margin-bottom:28px;font-size:27.725793726205858px;font-family:Montserrat,sans-serif;line-height:1.1;font-weight:900;}.css-1ieeh81 a{visibility:hidden;}.css-1ieeh81:hover a{visibility:visible;}</style><h2 id="처음-생각했던-구현-방향" class="css-1ieeh81"><style data-emotion-css="25cxt7">.css-25cxt7{margin-left:-20px;padding-right:4px;color:var(--theme-ui-colors-primary,#663399);}</style><a href="#처음-생각했던-구현-방향" class="css-25cxt7"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>처음 생각했던 구현 방향</h2><style data-emotion-css="1mv7wyt">.css-1mv7wyt{padding:0;margin:0;margin-bottom:28px;}.css-1mv7wyt code{font-size:inherit;}</style><p class="css-1mv7wyt"> <!-- --> next.js가 serverless target build 기능을 release한 지 그리 오래 되진 않았지만 꽤 시간이 흘렀다. 그때 당시에는 꼭 한번 사용해봐야지라는 생각만 했었다.
그래서 이번 글을 써야 겠다라고 마음을 먹고 머릿속으로 어떻게 구현할 수 있을까 고민하기 시작했때에는 다음과 같이 구현 해야 겠다고 생각헀다. next.js page들을 lambda 함수로 build하고 api-gateway를 활용해서 각 lambda들을 call하게 해주고,
cache는 elasticcache를 통해서 api 혹은 page를 render한 결과물을 cache하는 형태로 구성해야겠다라고 생각을 했었다.
그런데 직접 구현 해보고 글을 써야지라고 마음을 먹고 직접 코드를 치기 시작하고 이것 저것 검색을 하다 보니 <style data-emotion-css="xf5nv2">.css-xf5nv2{color:var(--theme-ui-colors-primary,#663399);}</style><a href="https://github.com/danielcondemarin/serverless-next.js/tree/master/packages/serverless-nextjs-component" class="css-xf5nv2">serverless-next.js</a>라는 것을 알게 되었다.
또한 친절하게 소개되어 있는 <a href="https://serverless.com/blog/serverless-nextjs/" class="css-xf5nv2">블로그 글</a>도 있었다. 읽어 보니 이대로 실습을 해보는 것이 더 좋겠다는 생각이 들었다.</p><h2 id="실습한-결과물-공유-및-느낀-점" class="css-1ieeh81"><a href="#실습한-결과물-공유-및-느낀-점" class="css-25cxt7"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>실습한 결과물 공유 및 느낀 점</h2><style data-emotion-css="1dahk1j">.css-1dahk1j{padding:0;margin:0;margin-bottom:28px;margin-left:28px;margin-right:28px;color:inherit;border-left-color:inherit;opacity:0.8;}.css-1dahk1j.translation{font-size:1em;}</style><blockquote class="css-1dahk1j"><p class="css-1mv7wyt">1) nginx + react + express (with puppeteer) - <a href="https://impressor615.github.io/first-react-ssr/" class="css-xf5nv2">블로그 링크</a> <br/>
2) <style data-emotion-css="1pnz7gf">.css-1pnz7gf{border-radius:0.3em;color:var(--theme-ui-colors-secondary,#1B1F23);background-color:var(--theme-ui-colors-highlight,rgba(255,229,100,0.2));padding-top:0.15em;padding-bottom:0.05em;padding-left:0.2em;padding-right:0.2em;}</style><code class="css-1pnz7gf">next.js의 serverless</code> - <a href="https://impressor615.github.io/first-react-ssr/" class="css-xf5nv2">참고 repository</a>  <br/>
3) (coming soon) cloudFront + lambda@edge <br/></p></blockquote><p class="css-1mv7wyt"> <!-- --> 처음 생각했던 구성대로 작업하려고 했다면 aws관련한 공부도 많이 해야 했고 꽤 많은 시간을 써야할 것이라고 예상 했었다.
그런데 실제로 serverless에서 소개되고 있는 블로그 글을 기반으로 하다 보니 실제 작업이 생각보다 빨리 끝났다. 파일들을 거의 기본 next.js application과 serverless-next.js에서 필요한 config 파일 정도 뿐이다.
그래서 코드에 대한 이야기는 크게 하지 않아도 될 것 같고 serverless-next.js가 해주는 전체적인 구조와 관련된 생각 정도만 정리해 보려고 한다.
글의 초입부와 글의 마지막에 공유한 blog글에 serverless-next.js에서 구성해주는 구조를 잘 그려 두었다. 해당 이미지를 아래로 옮겨 와 보았다.</p><p class="css-1mv7wyt"><style data-emotion-css="12yi5u7">.css-12yi5u7{padding:0;margin:0;margin-bottom:28px;max-width:100%;}</style><img src="https://s3-us-west-2.amazonaws.com/assets.blog.serverless.com/serverless-nextjs/serverless_nextjs_lambda_edge_aws_architecture.png" alt="second-react-ssr-diagram" class="css-12yi5u7"/></p><p class="css-1mv7wyt"> <!-- --> 위의 그림을 간단히만 글로 설명한디면, user가 도메인을 입력하게 되면 cloudFront로 요청이 전달되고 build assets, user assets은 바로 s3로 전달 되어 파일이 return된다. 그 이외의 정적인 <code class="css-1pnz7gf">.html</code>로
만들어 진 페이지, <code class="css-1pnz7gf">/manifest.json</code>, <code class="css-1pnz7gf">/robot.txt</code>와 같은 public assest, 그리고 <code class="css-1pnz7gf">ssr이 필요한 page</code>에 대한 요청과 <code class="css-1pnz7gf">api 요청</code>은 <code class="css-1pnz7gf">lambda@edge로 전달되어 각 요청에 맞게 처리되어 return</code>된다.
public asset이나 getInitialProps가 사용되지 않아서 <code class="css-1pnz7gf">.html파일로 만들어진 파일도 lambda를 통한 다는 것이 마음에 들지 않았고 굳이 그럴 필요가 있나 생각이 들었다. 역시는 역시. 이유가 있었다.</code>
cloudFront에서 cache에 대한 rule을 최대 25개까지만 만들 수 있기 때문이었다. 이 부분만 해결할 수 있는 방법이 있다면 훨씬 좋겠다라는 생각을 했다. 아쉬웠다.</p><p class="css-1mv7wyt"> <!-- --> 다음으로, 중요 하기도 하고 주목할 만 했던 부분이 cache와 관련된 부분이었다. <code class="css-1pnz7gf">SSR을 하게 되면 api 요청에 대한 결과를 받고 page를 render하고 내리는 과정이 동반 되기 때문에
SPA처럼 단순히 index.html을 받는 과정보다 보통 오래 걸린다. 그래서 cache를 잘하는 것이 앱의 퍼포먼스에 굉장히 지대한 영향을 끼친다.</code>
serverless-next.js는 크게는 두 가지 기본 cache 정책을 가지고 있다. <code class="css-1pnz7gf">첫 번째로, build assets, user assets은 hash값과 함께 파일 이름이 생성되기 때문에 cache TTL이 max값으로 설정</code> 되어 있다.
<code class="css-1pnz7gf">두 번째로 page에 대한 요청 및 api 요청과 관련 되어 있는 lambda에 대한 cache 정책은 직접 변경 하지 않는 다면 기본적으로는 cache를 하지 않는다.</code></p><p class="css-1mv7wyt"> <!-- --> api lambda, page lambda에 대한 cache 정책에 대해서는 스스로 좀 더 신경써야 할 부분이라고 생각이 든다. (더 좋은 방법이 있는 지는 아직 모르겠지만) 기본 설정을 가지고 계속 작업 하기 보다는
<code class="css-1pnz7gf">page에 대한 요청과 api에 대한 요청도 예를 들어서 1시간 정도는 최소한 cache하도록 설정을 변경하여 사용하는 것이 바람직하지 않을까 싶다.</code> 그리고 배포하거나 혹은 <code class="css-1pnz7gf">cache invalidate가 필요할 때에는 cloudFront의 invalidation 기능을 사용 한다면
앱 성능면에 있어서 훨씬 도움이 될 거라는 생각이 들었다.</code> 물론 cache를 할 때에 로그인 여부, device, language등과 관련하여 <code class="css-1pnz7gf">api data나 page가 변경될 소지가 있는 부분에 대해서는 잘 고려 하여 cache 정책을 세워야 한다.</code>
물론, 실제로 서비스를 하다 보면 infra관련되어서든 application관련 되어서든 분명히 더 많은 문제들을 마주하게 되겠지만, 실습 하면서 느꼈던 점은 이 정도이다.</p><h2 id="스스로-생각해보는-장단점-및-결론" class="css-1ieeh81"><a href="#스스로-생각해보는-장단점-및-결론" class="css-25cxt7"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스스로 생각해보는 장단점 및 결론</h2><p class="css-1mv7wyt"> <!-- --> 위에 적었던 내용들을 토대로 장단점을 간단히 정리해보면 다음과 같다.</p><style data-emotion-css="1x1a47u">.css-1x1a47u{padding:0;margin:0;margin-bottom:28px;font-size:16px;font-family:Montserrat,sans-serif;line-height:1.1;font-weight:900;}</style><style data-emotion-css="177bogc">.css-177bogc{pointer-events:painted;padding:0;margin:0;margin-bottom:28px;font-size:16px;font-family:Montserrat,sans-serif;line-height:1.1;font-weight:900;}.css-177bogc a{visibility:hidden;}.css-177bogc:hover a{visibility:visible;}</style><h4 id="장점" class="css-177bogc"><a href="#장점" class="css-25cxt7"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>장점</h4><style data-emotion-css="wf0k3i">.css-wf0k3i{padding:0;margin:0;margin-bottom:28px;list-style-position:outside;list-style-image:none;margin-left:28px;}</style><ul class="css-wf0k3i"><style data-emotion-css="ikjsr2">.css-ikjsr2{margin-bottom:14px;padding-left:0;}.css-ikjsr2 ol{margin-top:14px;margin-bottom:14px;margin-left:28px;}.css-ikjsr2 ul{margin-top:14px;margin-bottom:14px;margin-left:28px;}.css-ikjsr2 p{margin-bottom:14px;}.css-ikjsr2 code{font-size:inherit;}</style><li class="css-ikjsr2">react SSR하면 next.js이다. react에서 공식적으로 추천 하고 있다.</li><li class="css-ikjsr2">next.js팀이 진짜 열심히 일한다. 개선의 체감속도 진짜 빠르다.</li><li class="css-ikjsr2">serverless라는 점에서 infra관리에 있어서 직접 서버를 띄우는 것보다 traffic관리에 있어서 좀 덜 신경써도 된다.</li></ul><h4 id="단점" class="css-177bogc"><a href="#단점" class="css-25cxt7"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단점</h4><ul class="css-wf0k3i"><li class="css-ikjsr2">lambda도 결국은 서버다. 많은 traffic이 몰릴 경우에 동시 처리의 수에 제한이 있다. (물론 해결할 수 있는 방법이야 있다.) 그러므로 직접 instance를 관리하는 것보다는 적을 수 있지만 infra에 대한 관리가 여전히 필요하다.</li><li class="css-ikjsr2">SPA라면 굳이 server로 traffic을 전달하지 않아도 되는 <code class="css-1pnz7gf">/*.html</code>, <code class="css-1pnz7gf">/robots.txt</code>등의 static한 파일도 lambda를 통해야 한다.</li><li class="css-ikjsr2">cache가 필요하고 고려할 것들이 꽤 많다. 실제로 user와 bot이 사용하는 결과물이 일치하므로, cache할 때에 신경써야 할 것이 좀 더 많다. 예를 들면 user의 language, device, 로그인 여부들을 서버 측에서 확인할 경우 예기치 못한 에러를 만날 수 있다.</li></ul><p class="css-1mv7wyt"> <!-- --> 결론적으로, <code class="css-1pnz7gf">개인적인 생각으로 SSR이 필요하고 cloudFront를 사용하여 서비스할 수 있는 상황이라면 사용을 고려 해보아도 좋다는 생각이 든다.</code>
직접 infra를 구현하는 것보다 훨씬 간편하다. 물론, 이미 infra관리에 익숙한 사람이라면 말이 다르겠지만.
다만 또 단점과 보완이 필요한 문제들도 있기 때문에 그런 부분에 대한 고려와 방안들을 갖추고 있다면 더할 나위 없이 좋은 선택이 될 수도 있다고 생각한다.</p><h2 id="참고한-글" class="css-1ieeh81"><a href="#참고한-글" class="css-25cxt7"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>참고한 글</h2><ul class="css-wf0k3i"><li class="css-ikjsr2"><a href="https://nextjs.org/" class="css-xf5nv2">https://nextjs.org/</a></li><li class="css-ikjsr2"><a href="https://serverless.com/blog/serverless-nextjs/" class="css-xf5nv2">https://serverless.com/blog/serverless-nextjs/</a></li></ul></main><style data-emotion-css="47xi18">.css-47xi18{margin-top:56px;padding-top:28px;}</style><footer class="css-47xi18"><style data-emotion-css="5rlcw3">.css-5rlcw3{padding:0;margin:0;margin-bottom:28px;border:0;border-bottom:1px solid;margin-top:-1px;border-color:var(--theme-ui-colors-muted,hsla(0,0%,0%,0.2));}</style><hr class="css-5rlcw3"/><style data-emotion-css="1hx7the">.css-1hx7the{margin-bottom:56px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion-css="1kt7aet">.css-1kt7aet{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:56px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion-css="xcwvoj">.css-xcwvoj{box-sizing:border-box;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:56px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-xcwvoj"><style data-emotion-css="14437zr">.css-14437zr{margin-right:14px;margin-bottom:0;width:48px;min-width:48px;border-radius:99999px;}</style><div class="css-14437zr gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:48px;height:48px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAEz0lEQVQ4ywHEBDv7AIR7dZeMh5KKhZGRjZaWkpyVjqaZj5eMgo6Ee4Z6clRNSktDPkxEPoyHe6CcjpuYjJuaj5ydk5uelKmlnAC+u7qilIusnZXX19Xd5uPM0s/Et6/ArJ+ShHhDOjkXFhwVFxwPEBRAQUO0w8O4yMu+z9TA09nD2+S8xcUAyMvLrZ2UuKeg8u3s5v//u+HsxL246c+/hHhyGRoiHx8kHB0hFhgcHiMnytTT4uvr3+nq5e7u5vLxzs3JALC+w7mmm8Cwpu/u7O///7ba6by3tPDVxYF0bg4SGxkbHyAeISIcHj8qLcLKyNvl5NXh4dfj49rp6sXDvwCqub+/rKDCsqrU5en0//+w0uSysK/eyLq0rqdOPkA5JCZRNDJVMC50TU2owMS0yc+xxs2wyM6pwsqkuLwAmKy2wayiwrGps9Da2vX7p8zgq6qs2sO30uXqk4qLXzMwc0M/cj86e1tUnKiqobvAoLe8n7a6mrK3k62yAIiapI6Ih56anLvS3J+2v3KIl4SAgXZtbXWBiYOQmGY4OHRCPWw9OWw6NXVdWoqWmH+Um3uPlHiLkHWHiAAyQktLVmFrdoOks8Cdr7l8j5tsam4oKTEUGiUsMTpDNjh4T0hzQj56VFSDcXCPf31+f39ugoZlfYNjeX4AN0hULjY+OTtAZGx1coSMdoaPeHN2NjAzXmNrZGpvZFVXnYN/qZGQkYKEVlBWaGFlhHZ0gnl2cX5/an+BAFVhaiwzO0JESqCqsNDc4qSuuGpnaV1TUpecoIyLjXVhZa+alrGemoZ3eGxhaG9mam9naXdpaXp0c4qengBaYGUtLTE6QkuLnaqsu8WNmqVoZWdgVFF7bmqBcm1+a3C1nZikkIx7bm92am1zaWtsYmZxZ2hmXl2AiIYAWlRSTUA7Qz9Bfo2YrMDNnaeucWZkbVtTgGxfgWdah3JxspiTlIF+dGdpdGdsZl5hWVJYXlhbXlhYe315AGhkYmtUSHJbUIF6dbbBx7i+wpF+dJF5aJqAbZ2BcINsbKaMiH5ubmpdX21iZVdQVktHTFdTW2RbW3p9eAB6h49rYVxURT5SSUJXU1V8enuTfW6aaVeXW0uRW051WFeZfXhzYWNrW1xbU1dFQEZOSlBlXmBiWFd6cWgAeYaQb4GLHCElICEkMC0uPTg1a1dPekU9aTIqVy8oTDo6hWxpYFJVYFJTQDxCPjk/Z1xgaV5eW1NSeXJlAC0vMVpiaVFQU29eVlBKSD45N0tAOmA/OINFO4JNP3dHPY9eUndSSmNMSUlCRUY+Q2FVV2JYWVpST3t5bgATExYrKCxyamxlV1NYSkIrKCcuJCNxPzZ+QzhwOjNuOjJuOTByOzF2S0F0ZmRoW1pSSUlHQUJWT0p1bl8AGRkaCgsOKCcrW1RVbllOQjcxMSQiVCsmOh0aNBwaNh8eKxsYKxwaKRocS0JFU01OUkhJOzY4NjMye25eABYWFg0OEAMEByonKlpOSGhSRikhHzEjHzooIDclHygdGhwVEiIcGx8eIiQjJjs4OjMxMTMvLUxFP2RYRwASEhMJCgsICgoGBgceGx1uVkhzWUpVQDYuIRsUDw8MCwwSDxEMDA0lIyQjIyUiIiIpKCZEPjVpWkdpWUYcoQa63GR7sAAAAABJRU5ErkJggg==" alt="Seonghyeon Kim" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/1277a6c527fe2ccfbb6143661cab5dca/984fe/avatar.png 1x,
/static/1277a6c527fe2ccfbb6143661cab5dca/c5212/avatar.png 1.5x,
/static/1277a6c527fe2ccfbb6143661cab5dca/5646f/avatar.png 2x" /><img loading="lazy" width="48" height="48" srcset="/static/1277a6c527fe2ccfbb6143661cab5dca/984fe/avatar.png 1x,
/static/1277a6c527fe2ccfbb6143661cab5dca/c5212/avatar.png 1.5x,
/static/1277a6c527fe2ccfbb6143661cab5dca/5646f/avatar.png 2x" src="/static/1277a6c527fe2ccfbb6143661cab5dca/984fe/avatar.png" alt="Seonghyeon Kim" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><div class="css-0">Usually develop web application</div></div><style data-emotion-css="11r1i3o">.css-11r1i3o{-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style:none;padding:0;}</style><style data-emotion-css="1qfxf3w">.css-1qfxf3w{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style:none;padding:0;}</style><ul class="css-1qfxf3w"><li><a rel="prev" class="css-xf5nv2" href="/first-react-ssr/">← <!-- -->React SSR하는 세 가지 방법 (1)</a></li><li></li></ul></footer></div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/second-react-ssr/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-af738798f5ab42d39990.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-b2dbbaec7db33016a868.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js-b703e6b1b78ba5eb5493.js"]};/*]]>*/</script><script src="/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-b2dbbaec7db33016a868.js" async=""></script><script src="/commons-37167ceaf9054f7f6325.js" async=""></script><script src="/app-af738798f5ab42d39990.js" async=""></script><script src="/styles-2c35f9c047bc332cf9af.js" async=""></script><script src="/webpack-runtime-9816a3b5d482d94d8ad0.js" async=""></script></body></html>